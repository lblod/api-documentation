<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>node_modules/@lblod/ember-contenteditable-editor/addon/utils/list-helpers.js - editor-documentation</title>
    <meta name="description" content="LBLOD editor Documentation pages">
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="stylesheet" href="../assets/css/custom.css">
    <link rel="stylesheet" href="../assets/vendor/bootstrap/css/bootstrap.css">
    <link rel="stylesheet" href="../assets/vendor/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="../assets/css/theme.css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700' rel='stylesheet' type='text/css'>
    

</head>
<body>
    <nav class="navbar navbar-default">
      <div class="container-fluid">
        <div class="navbar-header">
          <a href="../" class="navbar-brand">
              <img src="../assets/img/ember-logo.png" alt="enterprise logo">
            <span>editor-documentation</span>
          </a>
        </div>

        <div class="collapse navbar-collapse" id="nav">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="" class="fa fa-github github"></a></li>
          </ul>
        </div>
      </div>
    </nav>
    <div id="main-wrapper" class="row">
        <div id="content-wrapper">
            <ol class="panel-group" id="sidebar" role="tablist" aria-multiselectable="true">
                <li class="panel panel-default">
                    <div class="panel-heading" role="tab" id="sidebar-search-heading">
                        <h4 class="panel-title">
                      <a role="button" data-toggle="collapse" href="#sidebar-search" aria-expanded="true" aria-controls="collapseOne">
                        Search
                      </a>
                    </h4>
                    </div>
                    <div id="sidebar-search" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="sidebar-search-heading">
                        <div class="panel-body">
                            <div id="api-tabview-filter">
                                <input type="search" id="api-filter" placeholder="Search...">
                            </div>
                        </div>
                    </div>
                </li>
                    <li class="panel panel-default">
                        <div class="panel-heading" role="tab" id="sidebar-version-heading">
                            <h4 class="panel-title">
                                <a role="button" href="/commits/2bbb5b15" target="_blank">
                                  Tag: 0.0.0.2bbb5b15
                                </a>
                            </h4>
                        </div>
                    </li>
                <li class="panel panel-default">
                    <div class="panel-heading" role="tab" id="sidebar-modules-heading">
                        <h4 class="panel-title">
                    <a role="button" data-toggle="collapse" href="#sidebar-modules" aria-expanded="true" aria-controls="collapseOne">
                      Modules
                    </a>
                  </h4>
                    </div>
                    <div id="sidebar-modules" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="sidebar-modules-heading">
                        <div class="panel-body">
                                <ol>
                                        <li>
                                            <a href="../modules/contenteditable-editor.html">contenteditable-editor</a>
                                        </li>
                                        <li>
                                            <a href="../modules/editor-core.html">editor-core</a>
                                        </li>
                                        <li>
                                            <a href="../modules/pernetApi.html">pernetApi</a>
                                        </li>
                                        <li>
                                            <a href="../modules/rdfa-editor.html">rdfa-editor</a>
                                        </li>
                                </ol>
                        </div>
                    </div>
                </li>
            
                <li class="panel panel-default">
                    <div class="panel-heading" role="tab" id="sidebar-classes-heading">
                        <h4 class="panel-title">
                      <a role="button" data-toggle="collapse" href="#sidebar-classes" aria-expanded="true" aria-controls="collapseOne">
                        Classes
                      </a>
                    </h4>
                    </div>
                    <div id="sidebar-classes" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="sidebar-classes-heading">
                        <div class="panel-body">
                            <ol>
                                    <li>
                                        <a href="../classes/ArrowHandler.html">ArrowHandler</a>
                                    </li>
                                    <li>
                                        <a href="../classes/BackspaceHandler.html">BackspaceHandler</a>
                                    </li>
                                    <li>
                                        <a href="../classes/BoldProperty.html">BoldProperty</a>
                                    </li>
                                    <li>
                                        <a href="../classes/CappedHistory.html">CappedHistory</a>
                                    </li>
                                    <li>
                                        <a href="../classes/ContentEditableComponent.html">ContentEditableComponent</a>
                                    </li>
                                    <li>
                                        <a href="../classes/DocumentStructureComponent.html">DocumentStructureComponent</a>
                                    </li>
                                    <li>
                                        <a href="../classes/DomHelpers.html">DomHelpers</a>
                                    </li>
                                    <li>
                                        <a href="../classes/EditorProperty.html">EditorProperty</a>
                                    </li>
                                    <li>
                                        <a href="../classes/EmphasisMarkdownHandler.html">EmphasisMarkdownHandler</a>
                                    </li>
                                    <li>
                                        <a href="../classes/EnterHandler.html">EnterHandler</a>
                                    </li>
                                    <li>
                                        <a href="../classes/EventProcessor.html">EventProcessor</a>
                                    </li>
                                    <li>
                                        <a href="../classes/HandlerResponse.html">HandlerResponse</a>
                                    </li>
                                    <li>
                                        <a href="../classes/HeaderMarkdownHandler.html">HeaderMarkdownHandler</a>
                                    </li>
                                    <li>
                                        <a href="../classes/HintsRegistry.html">HintsRegistry</a>
                                    </li>
                                    <li>
                                        <a href="../classes/HintsRegistryDebugger.html">HintsRegistryDebugger</a>
                                    </li>
                                    <li>
                                        <a href="../classes/IgnoreModifiersHandler.html">IgnoreModifiersHandler</a>
                                    </li>
                                    <li>
                                        <a href="../classes/ItalicProperty.html">ItalicProperty</a>
                                    </li>
                                    <li>
                                        <a href="../classes/ListInsertionMarkdownHandler.html">ListInsertionMarkdownHandler</a>
                                    </li>
                                    <li>
                                        <a href="../classes/NodeWalker.html">NodeWalker</a>
                                    </li>
                                    <li>
                                        <a href="../classes/RawEditor.html">RawEditor</a>
                                    </li>
                                    <li>
                                        <a href="../classes/RdfaBackspaceHandler.html">RdfaBackspaceHandler</a>
                                    </li>
                                    <li>
                                        <a href="../classes/RdfaBlock.html">RdfaBlock</a>
                                    </li>
                                    <li>
                                        <a href="../classes/RdfaContextDebugger.html">RdfaContextDebugger</a>
                                    </li>
                                    <li>
                                        <a href="../classes/RdfaContextScanner.html">RdfaContextScanner</a>
                                    </li>
                                    <li>
                                        <a href="../classes/RdfaEditorComponent.html">RdfaEditorComponent</a>
                                    </li>
                                    <li>
                                        <a href="../classes/RdfaEditorDebugger.html">RdfaEditorDebugger</a>
                                    </li>
                                    <li>
                                        <a href="../classes/RdfaEditorDispatcher.html">RdfaEditorDispatcher</a>
                                    </li>
                                    <li>
                                        <a href="../classes/RdfaEditorLoadMonitor.html">RdfaEditorLoadMonitor</a>
                                    </li>
                                    <li>
                                        <a href="../classes/RdfaEditorSuggestedHintsComponent.html">RdfaEditorSuggestedHintsComponent</a>
                                    </li>
                                    <li>
                                        <a href="../classes/RdfaEditorToolbarComponent.html">RdfaEditorToolbarComponent</a>
                                    </li>
                                    <li>
                                        <a href="../classes/RichNode.html">RichNode</a>
                                    </li>
                                    <li>
                                        <a href="../classes/TextInputHandler.html">TextInputHandler</a>
                                    </li>
                                    <li>
                                        <a href="../classes/UnderlineProperty.html">UnderlineProperty</a>
                                    </li>
                            </ol>
                        </div>
                    </div>
                </li>
            </ol>
            <div class="content-container">
                <div class="apidocs">
                    <div id="docs-main">
                        <div class="content">
<div class="page-header">
    <h1><i class="fa fa-file-code-o" aria-hidden="true"></i>  File</h1>
</div>

<div class="file">
    <pre class="prettyprint linenums">
import {
  invisibleSpace,
  isDisplayedAsBlock,
  isList
} from &#x27;./dom-helpers&#x27;;
import { warn } from &#x27;@ember/debug&#x27;;

/**
 * Handlers for list action.
 *
 * - It works only when current node is a textNode
 * - The general flow is dependent on two situation types:
 *     a. Either the current node is already in al list when this action is fired.
 *         (see further notes for wat it basically means &#x27;being in a list&#x27;)
 *     b. Not in a list, create a new list
 *
 * TODO
 * ----
 *  - cursor positonining is uncontrolled right now, after action handled.
 *  - some times empty textnodes are not included in logicalBlock. Probably an issue with the conditoin isDisplayedAsBlock
 *
 * IMPLEMENTED BEHAVIOUR
 * ---------------------
 *   The &#x27;|&#x27; represents the cursor and gives an idea about the currentNode.
 *
 *  Some examples
 *
 *   case 1
 *   ------
 *   Call unorderedListAction x 1
 *   &#x60;&#x60;&#x60;
 *   | a some text
 *   &#x60;&#x60;&#x60;
 *   &#x60;&#x60;&#x60;
 *   &lt;ul&gt;
 *     &lt;li&gt;| a some text&lt;/li&gt;
 *   &lt;/ul&gt;
 *   &#x60;&#x60;&#x60;
 *
 *   case 2
 *   ------
 *   Call unorderedListAction x 1
 *   &#x60;&#x60;&#x60;
 *   a some &lt;span&gt; t | ext &lt;/span&gt;
 *   &#x60;&#x60;&#x60;
 *   &#x60;&#x60;&#x60;
 *   &lt;ul&gt;
 *     &lt;li&gt;a some &lt;span&gt; t | ext &lt;/span&gt;&lt;/li&gt;
 *   &lt;/ul&gt;
 *   &#x60;&#x60;&#x60;
 *
 *   case 3
 *   ------
 *   Call indent x 1
 *   &#x60;&#x60;&#x60;
 *    &lt;ul&gt;
 *     &lt;li&gt; a some &lt;div&gt; block element text | &lt;/div&gt;  other text &lt;/li&gt;
 *    &lt;/ul&gt;
 *   &#x60;&#x60;&#x60;
 *   &#x60;&#x60;&#x60;
 *    &lt;ul&gt;
 *      &lt;li&gt; a some
 *        &lt;ul&gt;
 *          &lt;li&gt;&lt;div&gt; block element text | &lt;/div&gt;&lt;/li&gt;
 *        &lt;/ul&gt;
 *        other text
 *      &lt;/li&gt;
 *    &lt;/ul&gt;
 *   &#x60;&#x60;&#x60;
 *
 *   case 4
 *   ------
 *   Call unorderedListAction x 1
 *    &#x60;&#x60;&#x60;
 *    A case |- with br-tag &lt;br&gt; new line. &lt;br&gt; we Will need to refine this.
 *    &#x60;&#x60;&#x60;
 *
 *    &#x60;&#x60;&#x60;
 *    &lt;ul&gt;
 *      &lt;li&gt;A case |- with br-tag &lt;br&gt; new line. &lt;br&gt; we Will need to refine this.&lt;/li&gt;
 *    &lt;/ul&gt;
 *    &#x60;&#x60;&#x60;
 *
 *   case 6
 *   ------
 *   Call unorderedListAction or unindent x 1
 *   &#x60;&#x60;&#x60;
 *   &lt;ul&gt;
 *     &lt;li&gt; The first &lt;/li&gt;
 *     &lt;li&gt;| a some text&lt;/li&gt;
 *     &lt;li&gt; the last &lt;/li&gt;
 *   &lt;/ul&gt;
 *   &#x60;&#x60;&#x60;
 *
 *    &#x60;&#x60;&#x60;
 *   &lt;ul&gt;
 *    &lt;li&gt; The first &lt;/li&gt;
 *   &lt;/ul&gt;
 *   | a some text
 *   &lt;ul&gt;
 *     &lt;li&gt; the last &lt;/li&gt;
 *   &lt;/ul&gt;
 *    &#x60;&#x60;&#x60;
 *
 *   case 7
 *   ------
 *   Call unorderedListAction or unindent x 1
 *   &#x60;&#x60;&#x60;
 *   &lt;ul&gt;
 *     &lt;li&gt;| a some text&lt;/li&gt;
 *   &lt;/ul&gt;
 *   &#x60;&#x60;&#x60;
 *
 *    &#x60;&#x60;&#x60;
 *    a some &lt;span&gt; t | ext &lt;/span&gt;
 *    &#x60;&#x60;&#x60;
 *
 *   case 8
 *   ------
 *   Call unorderedListAction or unindent x 1
 *   &#x60;&#x60;&#x60;
 *    &lt;ul&gt;
 *     &lt;li&gt; a | some &lt;div&gt; block element text &lt;/div&gt;  other text &lt;/li&gt;
 *    &lt;/ul&gt;
 *   &#x60;&#x60;&#x60;
 *   &#x60;&#x60;&#x60;
 *    &lt;ul&gt;
 *     &lt;li&gt; &lt;div&gt; block element text &lt;/div&gt;  other text &lt;/li&gt;
 *    &lt;/ul&gt;
 *    a | some
 *   &#x60;&#x60;&#x60;
 *
 *   case 9
 *   ------
 *   Call unorderedListAction or unindent x 1
 *   &#x60;&#x60;&#x60;
 *    &lt;ul&gt;
 *      &lt;li&gt; item 1&lt;/li&gt;
 *     &lt;li&gt;
 *       &lt;ul&gt;
 *          &lt;li&gt; subitem 1&lt;/li&gt;
 *          &lt;li&gt; subitem | 2 &lt;/li&gt;
 *          &lt;li&gt; subitem 3&lt;/li&gt;
 *       &lt;/ul&gt;
 *     &lt;/li&gt;
 *     &lt;li&gt; item 2&lt;/li&gt;
 *    &lt;/ul&gt;
 *   &#x60;&#x60;&#x60;
 *   &#x60;&#x60;&#x60;
 *    &lt;ul&gt;
 *      &lt;li&gt; item 1&lt;/li&gt;
 *     &lt;li&gt;
 *       &lt;ul&gt;
 *          &lt;li&gt; subitem 1&lt;/li&gt;
 *       &lt;/ul&gt;
 *     &lt;/li&gt;
 *     &lt;li&gt; subitem | 2 &lt;/li&gt;
 *     &lt;li&gt;
 *       &lt;ul&gt;
 *          &lt;li&gt; subitem 3&lt;/li&gt;
 *       &lt;/ul&gt;
 *     &lt;/li&gt;
 *     &lt;li&gt; item 2&lt;/li&gt;
 *    &lt;/ul&gt;
 *   &#x60;&#x60;&#x60;
 *
 *   case 10
 *   ------
 *   Call unorderedListAction or unindent x 1
 *
 *   &#x60;&#x60;&#x60;
 *    &lt;ul&gt;
 *      &lt;li&gt; item 1&lt;/li&gt;
 *     &lt;li&gt;
 *       &lt;ul&gt;
 *          &lt;li&gt; subitem 1&lt;/li&gt;
 *          &lt;li&gt;&lt;div&gt; subitem | 2 &lt;/div&gt;&lt;/li&gt;
 *          &lt;li&gt; subitem 3&lt;/li&gt;
 *       &lt;/ul&gt;
 *     &lt;/li&gt;
 *     &lt;li&gt; item 2&lt;/li&gt;
 *    &lt;/ul&gt;
 *   &#x60;&#x60;&#x60;
 *   &#x60;&#x60;&#x60;
 *    &lt;ul&gt;
 *      &lt;li&gt; item 1&lt;/li&gt;
 *     &lt;li&gt;
 *       &lt;ul&gt;
 *          &lt;li&gt; subitem 1&lt;/li&gt;
 *       &lt;/ul&gt;
 *     &lt;/li&gt;
 *     &lt;li&gt;&lt;div&gt; subitem | 2 &lt;/div&gt;&lt;/li&gt;
 *     &lt;li&gt;
 *       &lt;ul&gt;
 *          &lt;li&gt; subitem 3&lt;/li&gt;
 *       &lt;/ul&gt;
 *     &lt;/li&gt;
 *     &lt;li&gt; item 2&lt;/li&gt;
 *    &lt;/ul&gt;
 *   &#x60;&#x60;&#x60;
 *
 *   case 11
 *   ------
 *   Call unorderedListAction x 1
 *
 *   &#x60;&#x60;&#x60;
 *   &lt;ul&gt;
 *     &lt;li&gt; The first &lt;/li&gt;
 *     &lt;li&gt;| a some text&lt;/li&gt;
 *     &lt;li&gt; the last &lt;/li&gt;
 *   &lt;/ul&gt;
 *   &#x60;&#x60;&#x60;
 *
 *   &#x60;&#x60;&#x60;
 *   &lt;ol&gt;
 *     &lt;li&gt; The first &lt;/li&gt;
 *     &lt;li&gt;| a some text&lt;/li&gt;
 *     &lt;li&gt; the last &lt;/li&gt;
 *   &lt;/ol&gt;
 */

/**
 * handles unordered list
 */
const unorderedListAction = function ( rawEditor ) {
  const currentNode = rawEditor.currentNode;

  if(!isEligibleForListAction(currentNode)) return;

  rawEditor.externalDomUpdate(&#x27;handle unorderedListAction&#x27;,
                              handleListAction(rawEditor, currentNode, unorderedListAction, &#x27;ul&#x27;),
                             true);
};

/**
 * handles ordered list
 */
const orderedListAction = function ( rawEditor ) {
  const currentNode = rawEditor.currentNode;

  if(!isEligibleForListAction(currentNode)) return;

  rawEditor.externalDomUpdate(&#x27;handle orderedListAction&#x27;,
                              handleListAction(rawEditor, currentNode, orderedListAction, &#x27;ol&#x27;),
                             true);
};

/**
 * handles indent Action
 */
const indentAction = function ( rawEditor ) {
  const currentNode = rawEditor.currentNode;

  if(!isEligibleForListAction(currentNode)) return;

  let handleAction = () =&gt; {
    if(!isEligibleForIndentAction(currentNode)) return;

    let currLI = getParentLI(currentNode);
    let currlistE = currLI.parentNode;
    let currlistType = getListTagName(currlistE);
    let logicalBlockContents = getLogicalBlockContentsForIndentationAction(currentNode);
    insertNewList(rawEditor, logicalBlockContents, currlistType);
  };

  rawEditor.externalDomUpdate(&#x27;handle indentAction&#x27;, handleAction, true);
};

/**
 * handles unindent Action
 */
const unindentAction = function ( rawEditor ) {
  const currentNode = rawEditor.currentNode;

  if(!isEligibleForListAction(currentNode)) return;

  let handleAction = () =&gt; {
    if(!isEligibleForIndentAction(currentNode)) return;

    let logicalBlockContents = getLogicalBlockContentsForIndentationAction(currentNode);
    unindentLogicalBlockContents(rawEditor, logicalBlockContents);
  };

  rawEditor.externalDomUpdate(&#x27;handle unindentAction&#x27;, handleAction, true);
};


/***************************************************
 * HELPERS
 ***************************************************/

/**
 * Boilerplate to handle List action
 * Both for UL and OL
 */
const handleListAction = ( rawEditor, currentNode, actionType, listType) =&gt; {
  return () =&gt; {
    if(!isInList(currentNode)){
      let logicalBlockContents = getLogicalBlockContentsForNewList(currentNode);
      insertNewList(rawEditor, logicalBlockContents, listType);
      return;
    }

    if(doesActionSwitchListType(currentNode, actionType)){
      let logicalBlockContents = getLogicalBlockContentsSwitchListType(currentNode);
      shuffleListType(rawEditor, logicalBlockContents);
      return;
    }

    let logicalBlockContents = getLogicalBlockContentsForIndentationAction(currentNode);
    unindentLogicalBlockContents(rawEditor, logicalBlockContents);
  };
};

/**
 * Checks whether node is in a list
 *
 *   EXAMPLES NOT IN A LIST
 *   ----------------------
 *
 *   &#x60;&#x60;&#x60;
 *   | a some text
 *   &#x60;&#x60;&#x60;
 *
 *    &#x60;&#x60;&#x60;
 *    a some &lt;span&gt; t | ext &lt;/span&gt;
 *    &#x60;&#x60;&#x60;
 *
 *   EXAMPLES IN A LIST
 *   ------------------
 *
 *    Note here: when in a nested list context even if cursors is in block element,
 *    we return true
 *    &#x60;&#x60;&#x60;
 *    &lt;ul&gt;
 *     &lt;li&gt; a some &lt;div&gt; block element text | &lt;/div&gt;  other text &lt;/li&gt;
 *    &lt;/ul&gt;
 *    &#x60;&#x60;&#x60;
 *
 *   &#x60;&#x60;&#x60;
 *   &lt;ul&gt;
 *     &lt;li&gt; some text
 *         &lt;a href=&quot;#&quot;&gt;an &lt;i&gt; italic | &lt;/i&gt; link&lt;/a&gt;
 *     &lt;/li&gt;
 *   &lt;/ul&gt;
 *   &#x60;&#x60;&#x60;
 */
const isInList = ( node ) =&gt; {
  let currNode = node.parentNode;
  while(currNode){

    if(isLI(currNode)) return true;

    currNode = currNode.parentNode;
  }

  return false;
};

/**
 * Inserts a new list.
 *
 */
const insertNewList = ( rawEditor, logicalListBlocks, listType = &#x27;ul&#x27; ) =&gt; {
  let listELocationRef = logicalListBlocks[0];

  let listE = document.createElement(listType);
  let li = document.createElement(&#x27;li&#x27;);
  listE.append(li);

  let parent = listELocationRef.parentNode;

  if(!parent){
    warn(&#x27;Lists assume a parent node&#x27;, {id: &#x27;list-helpers:insertNewList&#x27;});
    return;
  }

  parent.insertBefore(listE, listELocationRef);
  logicalListBlocks.forEach(n =&gt; li.appendChild(n));

  makeLogicalBlockCursorSafe([listE]);
};

/**
 * Unindents logical block contents from context it resides in.
 */
const unindentLogicalBlockContents = ( rawEditor, logicalBlockContents, moveOneListUpwards= false ) =&gt; {
  let currLI = getParentLI(logicalBlockContents[0]);
  let listE = currLI.parentNode;
  let listType = getListTagName(listE);
  let parentE = listE.parentNode;
  let allLIs = [...listE.children];

  if(!currLI || !listE || !parentE){
    warn(&#x27;No wrapping LI/List/Parent of list found!&#x27;, {id: &#x27;list-helpers:unindentLIAndSplitList&#x27;});
    return;
  }

  let [LIsBefore, LIsAfter] = siblingsBeforeAndAfterLogicalBlockContents(allLIs, [currLI]);
  let [siblingsBefore, siblingsAfter] = siblingsBeforeAndAfterLogicalBlockContents([...currLI.childNodes], logicalBlockContents);

  logicalBlockContents = makeLogicalBlockCursorSafe(logicalBlockContents);
  [siblingsBefore, siblingsAfter] = [ makeLogicalBlockCursorSafe(siblingsBefore), makeLogicalBlockCursorSafe(siblingsAfter)];

  if(siblingsBefore.length &gt; 0){
    let li = createParentWithLogicalBlockContents(siblingsBefore, &#x27;li&#x27;);
    LIsBefore.push(li);
  }

  if(siblingsAfter.length &gt; 0){
    let li = createParentWithLogicalBlockContents(siblingsAfter, &#x27;li&#x27;);
    LIsAfter = [li, ...LIsAfter];
  }

  //If we don&#x27;t need to move our logical block on list up,
  //we will split the list in two and make sure the logicalBlock
  //resides in between
  if(!moveOneListUpwards){

    if(LIsBefore.length &gt; 0){
      let listBefore = createParentWithLogicalBlockContents(LIsBefore, listType);
      parentE.insertBefore(listBefore, listE);
    }

    logicalBlockContents.forEach(n =&gt; parentE.insertBefore(n, listE));

    if(LIsAfter.length &gt; 0){
      let listAfter = createParentWithLogicalBlockContents(LIsAfter, listType);
      parentE.insertBefore(listAfter, listE);
    }
  }

  //We are in highest list in context, and we didn&#x27;t start from nested context
  if(!isInList(listE) &amp;&amp; !moveOneListUpwards){
    makeLogicalBlockCursorSafe([listE]);
    listE.removeChild(currLI);
    parentE.removeChild(listE); //we don&#x27;t need the original list
    return;
  }

  //Current list is a nested list, and the block needs to move one LI up
  if(isInList(listE) &amp;&amp; !moveOneListUpwards){
    listE.removeChild(currLI);
    parentE.removeChild(listE); //we don&#x27;t need the original list
    unindentLogicalBlockContents(rawEditor, logicalBlockContents, true);
    return;
  }

  //We don&#x27;t care wether our current list is nested. We just need to add the new LI&#x27;s
  if(moveOneListUpwards){
    let li = createParentWithLogicalBlockContents(logicalBlockContents, &#x27;li&#x27;);
    let newLIs = [...LIsBefore, li, ...LIsAfter];
    newLIs.forEach(n =&gt; listE.appendChild(n));
    listE.removeChild(currLI);
  }
};

/**
 * Switches list type where currentNode is situated in.
 */
const shuffleListType = ( rawEditor, logicalBlockContents) =&gt; {
  let currlistE = logicalBlockContents[0];
  let currlistType = getListTagName(currlistE);
  let targetListType = currlistType == &#x27;ul&#x27;?&#x27;ol&#x27;:&#x27;ul&#x27;;
  let parentE = currlistE.parentNode;
  let allLIs = [...currlistE.children];

  let listE = document.createElement(targetListType);
  allLIs.forEach(li =&gt; listE.append(li));

  parentE.insertBefore(listE, currlistE);
  parentE.removeChild(currlistE);
};

const doesActionSwitchListType = ( node, listAction ) =&gt; {
  let li = getParentLI(node);
  let listE = li.parentElement;
  let listType = getListTagName(listE);
  if(listType == &#x27;ul&#x27; &amp;&amp; listAction == unorderedListAction){
    return false;
  }
  if(listType == &#x27;ol&#x27; &amp;&amp; listAction == orderedListAction){
    return false;
  }
  return true;
};

const getParentLI = (node) =&gt; {
  if(!node.parentNode) return null;
  if(isLI(node.parentNode)) return node.parentNode;
  return getParentLI(node.parentNode);
};

const isLI = ( node ) =&gt; {
  return node.nodeType === node.ELEMENT_NODE &amp;&amp; [&#x27;li&#x27;].includes(node.tagName.toLowerCase());
};

const isTextNode = ( node ) =&gt; {
  return node.nodeType === Node.TEXT_NODE;
};

const getListTagName = ( listElement ) =&gt; {
  return [&#x27;ul&#x27;].includes(listElement.tagName.toLowerCase()) ? &#x27;ul&#x27; : &#x27;ol&#x27;;
};

/**
 * Given a node, we want to grow a region (a list of nodes)
 * we consider sensible for inserting a new list
 *
 * CURRENT IMPLEMENTATION
 * ----------------------
 *
 * Best to use an example. &quot;|&quot; is cursor.
 * &#x60;&#x60;&#x60;
 * &lt;p&gt;
 *  bla bal &lt;span&gt;&lt;a href=&quot;#&quot;&gt; foo | &lt;br&gt;&lt;/a&gt; test &lt;div&gt; a block &lt;/div&gt;
 * &lt;/p&gt;
 * &#x60;&#x60;&#x60;
 *
 *  The region we return.
 *
 *  &#x60;&#x60;&#x60;
 *  bla bal &lt;span&gt;&lt;a href=&quot;#&quot;&gt; foo | &lt;br&gt;&lt;/a&gt; test
 *  &#x60;&#x60;&#x60;
 * @method getLogicalBlockContentsForNewList
 *
 * @param {Object} domNode where cursor is
 *
 * @return [Array] [domNode1, ..., domNodeN]
 *
 * @public
 */
const getLogicalBlockContentsForNewList = ( node ) =&gt; {
  let baseNode = returnParentNodeBeforeBlockElement(node);
  //left and right adjacent siblings should be added until we hit a block node.
  return growNeighbouringSiblingsUntil(isDisplayedAsBlock, baseNode);
};

/**
 * Given a node in a list, we want to grow a region (a list of nodes)
 * we consider sensible to for switching the type of list.
 * In this case, we return the parent list dom element where current
 * domNode is in.
 *
 * @method getLogicalBlockContentsSwitchListType
 *
 * @param {Object} domNode where cursor is
 *
 * @return [Array] [domNode1, ..., domNodeN]
 *
 * @public
 */
const getLogicalBlockContentsSwitchListType = ( node ) =&gt; {
  let currLI = getParentLI(node);
  return [ currLI.parentNode ];
};

/**
 * Given a node in a nested list context, build the logicalBlock contents to perform
 * an unindent (i.e. unindent) action upon.
 *
 * CURRENT IMPLEMENTATION
 * ----------------------
 *
 * Best to use an example. &quot;|&quot; is cursor.
 *
 * Type case 1
 * -----------
 *
 * &#x60;&#x60;&#x60;
 * &lt;ol&gt;
 *   &lt;li&gt;
 *     &lt;ul&gt;
 *       some text |
 *     &lt;/ul&gt;
 *   &lt;/li&gt;
 *&lt;/ol&gt;
 * &#x60;&#x60;&#x60;
 *
 *  The region we return.
 *
 *  &#x60;&#x60;&#x60;
 *  some text |
 *  &#x60;&#x60;&#x60;
 *
 * Type case 2
 * -----------
 *
 * &#x60;&#x60;&#x60;
 * &lt;ol&gt;
 *   &lt;li&gt;
 *     &lt;ul&gt;
 *       some text &lt;div&gt; text in a block | &lt;/div&gt;
 *     &lt;/ul&gt;
 *   &lt;/li&gt;
 *&lt;/ol&gt;
 * &#x60;&#x60;&#x60;
 *
 *  The region we return.
 *
 *  &#x60;&#x60;&#x60;
 *  &lt;div&gt; text in a block | &lt;/div&gt;
 *  &#x60;&#x60;&#x60;
 * @method getLogicalBlockContentsForIndentationAction
 *
 * @param {Object} domNode where cursor is
 *
 * @return [Array] [domNode1, ..., domNodeN]
 *
 * @public
 */
const getLogicalBlockContentsForIndentationAction = ( node ) =&gt; {
  let currLI = getParentLI(node);
  let currLiNodes = [...currLI.childNodes];
  let potentialBlockParentCurrentNode = currLiNodes.find(n =&gt; isDisplayedAsBlock(n) &amp;&amp; n.contains(node));

  if(potentialBlockParentCurrentNode)
    return [ potentialBlockParentCurrentNode ];

  let baseNode = returnParentNodeBeforeBlockElement(node);
  return growNeighbouringSiblingsUntil(isDisplayedAsBlock, baseNode);
};

/**
 * Walk up the parents until a blockElement is matched.
 * return the node of wich the parent is the matching
 * block element
 * This is useful for fetching the span element in following example:
 *   &#x60;&#x60;&#x60;
 *    &lt;p&gt;
 *      text &lt;span&gt; foo &lt;a href=&quot;#&quot;&gt; current node | &lt;/a&gt;&lt;/span&gt;
 *    &lt;/p&gt;
 *   &#x60;&#x60;&#x60;
 *  The node we return.
 *
 *  &#x60;&#x60;&#x60;
 *  &lt;span&gt; foo &lt;a href=&quot;#&quot;&gt; current node | &lt;/a&gt;&lt;/span&gt;
 *  &#x60;&#x60;&#x60;
 */
const returnParentNodeBeforeBlockElement = ( node ) =&gt; {
  if(!node.parentNode) return node;

  if(isDisplayedAsBlock(node.parentNode)) {
    return node;
  }

  return returnParentNodeBeforeBlockElement(node.parentNode);
};

/**
 * Given a node, we want to grow a region (a list of sibling nodes)
 * until we match a condition
 */
const growNeighbouringSiblingsUntil = ( condition, node ) =&gt; {
  let nodes = [];
  let currNode = node;

  //lefties
  while(currNode){
    if(condition(currNode)){
      break;
    }
    nodes.push(currNode);
    currNode = currNode.previousSibling ;
  }

  nodes.reverse();

  //righties
  currNode = node.nextSibling;
  while(currNode){
    if(condition(currNode)){
      break;
    }
    nodes.push(currNode);
    currNode = currNode.nextSibling;
  }
  return nodes;
};

const isEligibleForListAction = ( node ) =&gt; {
  if(!isTextNode(node)){
    warn(&#x27;Current action only supported for textNodes&#x27;, {id: &#x27;list-helpers:isEligibleForListAction&#x27;});
    return false;
  }
  return true;
};

const isEligibleForIndentAction = ( node ) =&gt; {
  if(!isInList(node)){
      warn(&#x27;Indent only supported in context of list&#x27;, {id: &#x27;list-helpers:isEligibleForIndentAction&#x27;});
      return false;
  }
  return true;
};

const siblingsBeforeAndAfterLogicalBlockContents = ( allSiblings, logicalBlockContents ) =&gt; {
  let siblingsBefore = [];
  let siblingsAfter = [];
  let nodeListToUpdate = siblingsBefore;

  for(var node of allSiblings){
    if(logicalBlockContents.some(n =&gt; n.isSameNode(node))){
      nodeListToUpdate = siblingsAfter;
      continue;
    }
    nodeListToUpdate.push(node);
  }

  return [ siblingsBefore, siblingsAfter ];
};

const createParentWithLogicalBlockContents = ( logicalBlockContents, type ) =&gt; {
  let element = document.createElement(type);
  logicalBlockContents.forEach(n =&gt; element.appendChild(n));
  return element;
};

/**
 * Checks wether node is safe to put a cursor in. Checks either left or right from the node.
 */
const isNodeCursorSafe = ( node, before = true ) =&gt; {
  if(node.nodeType == Node.TEXT_NODE)
    return true;

  if(isLI(node))
    return true;

  let parent = node.parentNode;

  if(!parent)
    return true;

  if(before){
    let prevSibling = node.previousSibling;

   if(isList(node) &amp;&amp; isInList(node) &amp;&amp; !prevSibling) return true; //if &lt;li&gt;&lt;ul&gt;&lt;li&gt;pure nested list is ok &lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;

    if(!prevSibling || prevSibling.nodeType!= Node.TEXT_NODE) return false;
  }

  else {
    let nextSibling = node.nextSibling;
    if(isList(node) &amp;&amp; isInList(node) &amp;&amp; !nextSibling) return true; //if &lt;li&gt;&lt;ul&gt;&lt;li&gt;pure nested list is ok &lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;
    if(!nextSibling || nextSibling.nodeType!= Node.TEXT_NODE) return false;
  }

  return true;
};

/**
 * Makes sure logicalBlock is cursor safe.
 * By checking the first BlockContentNode as being safe at its left.
 * The last node is checked at its right.
 * Adds invisibleWhitespace
 * The inbetween elements are ignored.
 * (This function is basically something which should be executed at anthoer level)
 */
const makeLogicalBlockCursorSafe = ( logicalBlockContents ) =&gt; {
  if(logicalBlockContents.length == 0) return logicalBlockContents;

  let firstNode = logicalBlockContents[0];

  if(!isNodeCursorSafe(firstNode)){
    let textNode = document.createTextNode(invisibleSpace);
    firstNode.parentNode.insertBefore(textNode, firstNode);
    logicalBlockContents = [textNode, ...logicalBlockContents];
  }

  let lastNode = logicalBlockContents.slice(-1)[0];

  if(isNodeCursorSafe(lastNode, false))
    return logicalBlockContents;

  let textNode = document.createTextNode(invisibleSpace);
  let nextSibling = lastNode.nextSibling;

  if(!nextSibling){
    lastNode.parentNode.append(textNode);
  }
  else{
    lastNode.parentNode.insertBefore(textNode, nextSibling);
  }

  logicalBlockContents.push(textNode);

  return logicalBlockContents;
};

export { unorderedListAction, orderedListAction, indentAction, unindentAction }

    </pre>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="../assets/vendor/prettify/prettify-min.js"></script>
    <script>prettyPrint();</script>
    <script src="../assets/vendor/jquery/jquery.min.js"></script>
    <script src="../assets/vendor/jquery-ui/jquery-ui.min.js"></script>
    <script src="../assets/vendor/bootstrap/js/bootstrap.js"></script>
    <script src="../assets/vendor/github-slugger/slugger.js"></script>
    <script src="../assets/js/yuidoc-bootstrap.js"></script>
</body>
</html>
